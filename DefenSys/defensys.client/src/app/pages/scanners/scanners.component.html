<div class="max-w-4xl mx-auto">
  <h1 class="text-3xl font-bold text-white mb-6">Vulnerability Scanners</h1>

  <div *ngIf="!selectedScanner" class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <div (click)="selectScanner('sql_injection')" class="border border-gray-700 rounded-lg p-6 transition hover:border-sky-500 cursor-pointer bg-gray-800">
      <div class="flex items-center space-x-4">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-sky-400">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
          </svg>
        </div>
        <div>
          <h2 class="font-bold text-xl text-white">SQL Injection</h2>
          <p class="text-gray-400 mt-1">Scan for SQL injection vulnerabilities.</p>
        </div>
      </div>
    </div>

    <div (click)="selectScanner('xss')" class="border border-gray-700 rounded-lg p-6 transition hover:border-sky-500 cursor-pointer bg-gray-800">
      <div class="flex items-center space-x-4">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-sky-400">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 12" />
          </svg>
        </div>
        <div>
          <h2 class="font-bold text-xl text-white">XSS Scan</h2>
          <p class="text-gray-400 mt-1">Scan for Cross-Site Scripting.</p>
        </div>
      </div>
    </div>

    <div (click)="selectScanner('command_injection')" class="border border-gray-700 rounded-lg p-6 transition hover:border-sky-500 cursor-pointer bg-gray-800">
      <div class="flex items-center space-x-4">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-sky-400">
            <path stroke-linecap="round" stroke-linejoin="round" d="m6.75 7.5 3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0 0 21 18V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v12a2.25 2.25 0 0 0 2.25 2.25Z" />
          </svg>
        </div>
        <div>
          <h2 class="font-bold text-xl text-white">Command Injection</h2>
          <p class="text-gray-400 mt-1">Scan for OS Command Injection.</p>
        </div>
      </div>
    </div>

  </div>

  <div *ngIf="selectedScanner === 'sql_injection'">
    <button (click)="deselectScanner()" class="mb-4 text-sky-400 hover:text-sky-300 transition">&larr; Back to scanner list</button>
    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
      <div class="mb-4">
        <h2 class="text-xl font-semibold text-sky-400">SQL Injection Scanner</h2>
        <p class="text-gray-400 text-sm mt-1">Checks for basic SQL Injection vulnerabilities.</p>
      </div>
      <hr class="border-gray-700 my-4">
      <div class="flex items-center space-x-4">
        <input [(ngModel)]="targetUrl" type="text" placeholder="Enter target URL (e.g., http://test.com/login?id=1)" class="flex-grow bg-gray-900 border border-gray-700 rounded-md py-2 px-4 text-white focus:ring-2 focus:ring-sky-500 focus:outline-none" [disabled]="isLoading">
        <button (click)="performScan('/api/sqlinjection/scan')" [disabled]="isLoading" class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-6 rounded-md transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
          <span *ngIf="!isLoading">Scan</span>
          <span *ngIf="isLoading">Scanning...</span>
        </button>
      </div>
      <div *ngIf="scanResult" class="mt-6 p-4 rounded-md" [ngClass]="{'bg-red-900 border border-red-700': scanResult.isVulnerable, 'bg-green-900 border border-green-700': !scanResult.isVulnerable}">
        <h3 class="font-bold" [ngClass]="{'text-red-400': scanResult.isVulnerable, 'text-green-400': !scanResult.isVulnerable}">Scan Result</h3>
        <p class="text-gray-300 mt-2">{{ scanResult.message }}</p>
        <p *ngIf="scanResult.testedUrl" class="text-gray-500 text-xs mt-2">Tested URL: <code>{{ scanResult.testedUrl }}</code></p>
      </div>
    </div>
  </div>

  <div *ngIf="selectedScanner === 'xss'">
    <button (click)="deselectScanner()" class="mb-4 text-sky-400 hover:text-sky-300 transition">&larr; Back to scanner list</button>
    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
      <div class="mb-4">
        <h2 class="text-xl font-semibold text-sky-400">Cross-Site Scripting (XSS) Scanner</h2>
        <p class="text-gray-400 text-sm mt-1">Checks for basic reflected XSS vulnerabilities.</p>
      </div>
      <hr class="border-gray-700 my-4">
      <div class="flex items-center space-x-4">
        <input [(ngModel)]="targetUrl" type="text" placeholder="Enter target URL (e.g., http://test.com/search?q=test)" class="flex-grow bg-gray-900 border border-gray-700 rounded-md py-2 px-4 text-white focus:ring-2 focus:ring-sky-500 focus:outline-none" [disabled]="isLoading">
        <button (click)="performScan('/api/xssscanner/scan')" [disabled]="isLoading" class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-6 rounded-md transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
          <span *ngIf="!isLoading">Scan</span>
          <span *ngIf="isLoading">Scanning...</span>
        </button>
      </div>
      <div *ngIf="scanResult" class="mt-6 p-4 rounded-md" [ngClass]="{'bg-red-900 border border-red-700': scanResult.isVulnerable, 'bg-green-900 border border-green-700': !scanResult.isVulnerable}">
        <h3 class="font-bold" [ngClass]="{'text-red-400': scanResult.isVulnerable, 'text-green-400': !scanResult.isVulnerable}">Scan Result</h3>
        <p class="text-gray-300 mt-2">{{ scanResult.message }}</p>
        <p *ngIf="scanResult.testedUrl" class="text-gray-500 text-xs mt-2">Tested URL: <code>{{ scanResult.testedUrl }}</code></p>
      </div>
    </div>
  </div>

  <div *ngIf="selectedScanner === 'command_injection'">
    <button (click)="deselectScanner()" class="mb-4 text-sky-400 hover:text-sky-300 transition">&larr; Back to scanner list</button>
    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
      <div class="mb-4">
        <h2 class="text-xl font-semibold text-sky-400">OS Command Injection Scanner</h2>
        <p class="text-gray-400 text-sm mt-1">Checks for basic OS command injection vulnerabilities.</p>
      </div>
      <hr class="border-gray-700 my-4">
      <div class="flex items-center space-x-4">
        <input [(ngModel)]="targetUrl" type="text" placeholder="Enter target URL (e.g., http://test.com/ping?ip=8.8.8.8)" class="flex-grow bg-gray-900 border border-gray-700 rounded-md py-2 px-4 text-white focus:ring-2 focus:ring-sky-500 focus:outline-none" [disabled]="isLoading">
        <button (click)="performScan('/api/commandinjectionscanner/scan')" [disabled]="isLoading" class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-6 rounded-md transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
          <span *ngIf="!isLoading">Scan</span>
          <span *ngIf="isLoading">Scanning...</span>
        </button>
      </div>
      <div *ngIf="scanResult" class="mt-6 p-4 rounded-md" [ngClass]="{'bg-red-900 border border-red-700': scanResult.isVulnerable, 'bg-green-900 border border-green-700': !scanResult.isVulnerable}">
        <h3 class="font-bold" [ngClass]="{'text-red-400': scanResult.isVulnerable, 'text-green-400': !scanResult.isVulnerable}">Scan Result</h3>
        <p class="text-gray-300 mt-2">{{ scanResult.message }}</p>
        <p *ngIf="scanResult.testedUrl" class="text-gray-500 text-xs mt-2">Tested URL: <code>{{ scanResult.testedUrl }}</code></p>
      </div>
    </div>
  </div>

</div>
