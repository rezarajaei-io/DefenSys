<div class="max-w-4xl mx-auto">
  <h1 class="text-3xl font-bold text-white mb-6">Vulnerability Scanners</h1>

  <div *ngIf="!selectedScanner" class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <div (click)="selectScanner('sql_injection')" class="border border-gray-700 rounded-lg p-6 transition hover:border-sky-500 cursor-pointer bg-gray-800">
      <div class="flex items-center ">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 text-sky-400 size-2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5" />
          </svg>
        </div>
        <div>
          <h2 class="font-bold text-xl text-white">SQL Injection</h2>
          <p class="text-gray-400 mt-1">Scan for SQL injection vulnerabilities.</p>
        </div>
      </div>
    </div>

    <div class="border border-gray-700 rounded-lg p-6 bg-gray-800 opacity-50 cursor-not-allowed">
      <h2 class="font-bold text-xl text-white">XSS Scan (Soon)</h2>
      <p class="text-gray-400 mt-1">Scan for Cross-Site Scripting.</p>
    </div>
  </div>

  <div *ngIf="selectedScanner === 'sql_injection'">

    <button (click)="deselectScanner()" class="mb-4 text-sky-400 hover:text-sky-300 transition">
      &larr; Back to scanner list
    </button>

    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
      <hr class="border-gray-700 my-4">

      <div class="flex items-center space-x-4">
        <input [(ngModel)]="targetUrl"
               type="text"
               placeholder="Enter target URL (e.g., http://test.com/login?id=1)"
               class="flex-grow bg-gray-900 border border-gray-700 rounded-md py-2 px-4 text-white focus:ring-2 focus:ring-sky-500 focus:outline-none"
               [disabled]="isLoading">
        <button (click)="onScanButtonClick()" [disabled]="isLoading" class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-6 rounded-md transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
          <span *ngIf="!isLoading">Scan</span>
          <span *ngIf="isLoading">Scanning...</span>
        </button>
      </div>

      <div *ngIf="scanResult" class="mt-6 p-4 rounded-md" [ngClass]="{
        'bg-red-900 border border-red-700': scanResult.isVulnerable,
        'bg-green-900 border border-green-700': !scanResult.isVulnerable
      }">
        <h3 class="font-bold" [ngClass]="{'text-red-400': scanResult.isVulnerable, 'text-green-400': !scanResult.isVulnerable}">
          Scan Result
        </h3>
        <p class="text-gray-300 mt-2">{{ scanResult.message }}</p>
        <p *ngIf="scanResult.testedUrl" class="text-gray-500 text-xs mt-2">
          Tested URL: <code>{{ scanResult.testedUrl }}</code>
        </p>
      </div>

    </div>
  </div>
</div>
